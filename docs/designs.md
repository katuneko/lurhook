# Lurhook å¤–éƒ¨è¨­è¨ˆæ›¸ï¼ˆå©ãå°ï¼‰

> **ç‰ˆæ•°:** v0.1ï¼ˆ2025â€‘05â€‘18ï¼‰
> **ä½œæˆè€…:** ãƒ¬ã‚ªï¼ˆã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆï¼‰
> **å‚ç…§:** Lurhook è¦ä»¶å®šç¾©æ›¸ v0.1

---

## 1. ã‚·ã‚¹ãƒ†ãƒ å…¨ä½“æ§‹æˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   Cargo workspace   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Executable â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¶â”‚ game-core  â”‚  â”€â” ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
        â–²                                           â”‚uses
        â”‚path                                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  uses  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  uses  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  uses  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ui      â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”‚  fishing â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”‚ ecology  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”‚ mapgen   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

* **gameâ€‘core**: å…¥åŠ›ï¼çŠ¶æ…‹é·ç§»ï¼ã‚¹ã‚±ã‚¸ãƒ¥ãƒ¼ãƒ©ã€‚
* **mapgen**: BSP + ãƒã‚¤ã‚ºç”Ÿæˆã€ã‚¿ã‚¤ãƒ«æ·±åº¦è¨ˆç®—ã€‚
* **ecology**: é­šã‚¹ãƒãƒ¼ãƒ³ & è¡Œå‹• AIã€‚
* **fishing**: ã‚­ãƒ£ã‚¹ãƒˆï¼ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãƒãƒ¼ï¼æ•ç²åˆ¤å®šã€‚
* **ui**: æç”»ãƒ©ãƒƒãƒ‘ & ã‚¦ã‚£ã‚¸ã‚§ãƒƒãƒˆã€‚
* **assets/**: JSON ãƒ‡ãƒ¼ã‚¿ + RON ã‚»ãƒ¼ãƒ–ãƒ•ã‚¡ã‚¤ãƒ«ã€‚
* **common**: å…±æœ‰ã®å‹ã¨ã‚¨ãƒ©ãƒ¼å®šç¾©ã€‚
* **game-core å†…éƒ¨ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«**: `ai.rs` ã¨ `ui.rs` ã«ãƒ­ã‚¸ãƒƒã‚¯ã¨æç”»å‡¦ç†ã‚’åˆ†å‰²ã—æ‹¡å¼µã«å‚™ãˆã‚‹ã€‚

## 2. å®Ÿè¡Œç’°å¢ƒ / ãƒ“ãƒ«ãƒ‰ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ

| ã‚¿ãƒ¼ã‚²ãƒƒãƒˆ             | å‡ºåŠ›                      | ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰    | å…¥åŠ›    | ãƒ“ãƒ«ãƒ‰æ–¹æ³•                                            |
| ----------------- | ----------------------- | --------- | ----- | ------------------------------------------------ |
| Desktop (default) | `lurhook.exe` / bin     | OpenGL    | ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ | `cargo run --release`                            |
| Terminal          | `lurhook_tui` (feature) | Crossterm | ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ | `cargo run --no-default-features --features tui` |
| WebAssembly       | `lurhook.wasm`          | WebGPU    | ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ | `wasm-pack build --target web`                   |

## 3. UI ä»•æ§˜ (ã‚¿ãƒ¼ãƒŸãƒŠãƒ« 80Ã—25)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ [32mLURHOOK v0.1[0m                                         â–¡     â”‚  <é‡£å…·ã‚¢ã‚¤ã‚³ãƒ³>
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚                                                â”‚
â”‚  @  )))  ~~~                                   â”‚  â† ãƒãƒƒãƒ—é ˜åŸŸ (60Ã—18)
â”‚  .. ~~~                                        â”‚
â”‚                                                â”‚
â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚Log                      â”‚ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹            â”‚
â”‚> é–‹å§‹åœ°ç‚¹ã â€¦            â”‚HP: â™¥â™¥â™¥  Food:[#####-----]â”‚
â”‚> é¤Œã‚’ä»˜ã‘ãŸã€‚            â”‚Line: â–“â–“â–“â–“           â”‚
â”‚> ...                    â”‚Depth: 12m          â”‚
â”‚                         â”‚Time: Dawn          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

* **Map Window**: `mapgen` ãŒç”Ÿæˆã™ã‚‹ã‚¿ã‚¤ãƒ«ã‚’æç”»ã€‚
* **Log Panel**: æœ€å¤§ 8 è¡Œã€‚ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«ã¯ PgUp/PgDnã€‚
* **Status Panel**: HP / Food / Line / Depth / æ™‚åˆ»ã€‚
* **ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãƒãƒ¼**: é‡£ã‚Šä¸­ã®ã¿ Map Bottom ã«è¡¨ç¤ºã€‚
* **ç…§æº–ãƒ¢ãƒ¼ãƒ‰**: ã‚­ãƒ£ã‚¹ãƒˆé–‹å§‹æ™‚ã« `*` ã§ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¿ã‚¤ãƒ«ã‚’ãƒã‚¤ãƒ©ã‚¤ãƒˆã—ã€æ–¹å‘ã‚­ãƒ¼ã§ç§»å‹•å¾Œ `c` ã§ç¢ºå®šã€‚
* **ã‚­ãƒ£ã‚¹ãƒˆã‚¢ãƒ‹ãƒ¡**: ç¢ºå®šå¾Œã€`*` ãŒæŠ•æ“²è»Œè·¡ã‚’æãæœ€å¾Œã« `o` ã‚’1ã‚¿ãƒ¼ãƒ³è¡¨ç¤ºã€‚
* **ã‚«ãƒ©ãƒ¼ãƒ–ãƒ©ã‚¤ãƒ³ãƒ‰ãƒ¢ãƒ¼ãƒ‰**: `lurhook.toml` ã« `colorblind = true` ã‚’è¨˜è¿°ã™ã‚‹ã¨
  é«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã®é…è‰²ã§è¡¨ç¤ºã•ã‚Œã‚‹ã€‚

## 4. å…¥åŠ›ã‚³ãƒãƒ³ãƒ‰ä¸€è¦§

| æ“ä½œ      | ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚­ãƒ¼         | èª¬æ˜               |
| ------- | --------------- | ---------------- |
| ç§»å‹•      | h/j/k/l or â†‘â†“â†â†’ | 8æ–¹å‘ã«1ã‚¿ã‚¤ãƒ«æ­©ã       |
| ã‚­ãƒ£ã‚¹ãƒˆ    | c               | ç…§æº–ãƒ¢ãƒ¼ãƒ‰ã«å…¥ã‚Šæ–¹å‘ï¼‹è·é›¢ã‚’é¸æŠ |
| å¼•ãä¸Šã’    | r               | ãƒ†ãƒ³ã‚·ãƒ§ãƒ³èª¿æ•´ (é‡£ã‚Šä¸­)    |
| ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒª  | i               | æ‰€æŒã‚¢ã‚¤ãƒ†ãƒ ç¢ºèª / ç«¿ãƒ»é¤Œå¤‰æ›´ |
| ç”Ÿé£Ÿ      | x               | é¸æŠä¸­ã®é­šã‚’é£Ÿã¹ã¦æº€è…¹å›å¾© |
| èª¿ç†      | f               | é™¸ä¸Šã§é­šã‚’ç„¼ã„ã¦æº€è…¹+40/HP+2 |
| æºè¡Œé£Ÿä½¿ç”¨ | g               | ç¼¶è©°ã‚’é£Ÿã¹ã¦æº€è…¹+60 |
| ãƒ­ã‚°ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ« | PgUp/PgDn       | éå»ãƒ­ã‚°é–²è¦§           |
| ãƒ˜ãƒ«ãƒ—      | F1              | æ“ä½œã‚¬ã‚¤ãƒ‰ã‚’è¡¨ç¤º/é–‰ã˜ã‚‹     |
| ã‚»ãƒ¼ãƒ–     | S               | å³æ™‚ä¿å­˜             |
| ãƒ­ãƒ¼ãƒ‰     | L               | ã‚¿ã‚¤ãƒˆãƒ«ã§ãƒ­ãƒ¼ãƒ‰ç”»é¢ã¸      |
| ãƒ©ãƒ³çµ‚äº†    | Enter           | ã‚¹ã‚³ã‚¢ã‚’é›†è¨ˆã—ã¦çµ‚äº†ç”»é¢ã¸ |
| çµ‚äº†      | Q               | ä¿å­˜ç¢ºèªå¾Œã«çµ‚äº†         |

ã‚­ãƒ¼ãƒªãƒãƒƒãƒ—ã¯ `lurhook.toml` ã«ä¿å­˜ã€‚

## 5. ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚¡ã‚¤ãƒ«ä»•æ§˜

### 5.1 é­šç¨®ãƒ‡ãƒ¼ã‚¿ `assets/fish.json`

```jsonc
[
  {
    "id": "LUR1",
    "name": "Lurker Bass",
    "rarity": 0.8,      // 0â€“1 ä½ã„ã»ã©ãƒ¬ã‚¢
    "strength": 12,     // ãƒ†ãƒ³ã‚·ãƒ§ãƒ³å¢—åŠ ä¿‚æ•°
    "min_depth": 10,
    "max_depth": 30,
    "fight_style": "Aggressive", // ãƒ•ã‚¡ã‚¤ãƒˆãƒ‘ã‚¿ãƒ¼ãƒ³
    "legendary": false
  }
]
```

### 5.2 ã‚»ãƒ¼ãƒ–ãƒ‡ãƒ¼ã‚¿ `save_*.ron`

```ron
(
  player: (
    pos: (x:12, y:7),
    hp: 3,
    inventory: [ (item:"BasicRod", dmg:0) ]
  ),
  map_seed: 123456,
  time_of_day: Dawn,
)
```

### 5.3 ã‚¢ã‚¤ãƒ†ãƒ ãƒ‡ãƒ¼ã‚¿ `assets/items.json`

```jsonc
[
  {
    "id": "BASIC_ROD",
    "name": "Basic Rod",
    "kind": "Rod",
    "tension_bonus": 0,
    "reel_factor": 1.0,
    "bite_bonus": 0.0
  }
]
```
* `kind` ã¯ `Rod` / `Reel` / `Lure` / `Food` ã®ã„ãšã‚Œã‹ã€‚
* `tension_bonus` ã¯æœ€å¤§ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã¸ã®åŠ ç®—å€¤ã€‚
* `reel_factor` ã¯ãƒªãƒ¼ãƒ«ã®åŠ¹æœä¿‚æ•°ã€‚1.0 ã§ç­‰å€ã€2.0 ã§2å€å¼•ãå¯„ã›ã€‚
* `bite_bonus` ã¯ãƒã‚¤ãƒˆç¢ºç‡ã¸ã®åŠ ç®—å€¤ã€‚

## 6. ä¸»è¦ãƒ­ã‚¸ãƒƒã‚¯ã‚·ãƒ¼ã‚±ãƒ³ã‚¹

### 6.1 ã‚¿ãƒ¼ãƒ³å‡¦ç†ãƒ•ãƒ­ãƒ¼

```
Player Input â†’ Update Systems â†’ AI Move / Spawn â†’ Resolve Collisions â†’ Render â†’ Wait
```
* ã‚¿ãƒ¼ãƒ³çµ‚äº†æ™‚ã«æº€è…¹åº¦ã‚’1æ¸›å°‘ã€‚0ã®å ´åˆã¯HPãŒ1æ¸›ã‚‹ã€‚
* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã®å…¥åŠ›ãŒã‚ã£ãŸå ´åˆã®ã¿1ã‚¿ãƒ¼ãƒ³é€²ã¿ã€ç„¡å…¥åŠ›ã§ã¯æ™‚é–“çµŒéã—ãªã„ã€‚
* ã‚¤ãƒ³ãƒ™ãƒ³ãƒˆãƒªç”»é¢ã§`X`ã‚’æŠ¼ã™ã¨é­šã‚’ç”Ÿé£Ÿã—ã¦æº€è…¹åº¦+20ã€‚
* é™¸ä¸Šã§`F`ã‚’æŠ¼ã™ã¨é­šã‚’èª¿ç†ã—ã¦æº€è…¹åº¦+40ã€HP+2ã€‚
* `G`ã‚’æŠ¼ã™ã¨æºè¡Œé£Ÿã‚’æ¶ˆè²»ã—ã¦æº€è…¹åº¦+60ã€‚


### 6.2 é‡£ã‚Šã‚·ãƒ¼ã‚±ãƒ³ã‚¹ (æˆåŠŸ)

```
ã‚­ãƒ£ã‚¹ãƒˆ â†’ å¾…æ©Ÿ (ã‚¿ã‚¤ãƒãƒ¼) â†’ ãƒã‚¤ãƒˆç™ºç”Ÿ â†’ ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚²ãƒ¼ãƒ  â†’ æˆåŠŸ â†’ é­šã‚’ Inventory ã¸
```

* ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ãŒ0ã«ãªã£ãŸå ´åˆã¯ãƒ•ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—å¤±æ•—æ‰±ã„ã€‚
* é­šã® `fight_style` ã«ã‚ˆã‚Šãƒ†ãƒ³ã‚·ãƒ§ãƒ³å¢—åŠ æŒ™å‹•ãŒå¤‰åŒ–ã™ã‚‹ã€‚

### 6.3 è¦–ç•Œåˆ¶é™

* ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒ `DeepWater` ã‚¿ã‚¤ãƒ«ä¸Šã«ã„ã‚‹å ´åˆã€è¦–ç•ŒåŠå¾„ã¯ 5 ãƒã‚¹ã«é™å®šã™ã‚‹ã€‚
* ç¯„å›²å¤–ã®ã‚¿ã‚¤ãƒ«ã¯æš—ç°è‰²ã§æç”»ã—ã€ä½ç½®ã®ã¿åˆ¤åˆ¥å¯èƒ½ã¨ã™ã‚‹ã€‚
* æ·±æµ·ã§ãƒ©ãƒ³ãƒ€ãƒ ã«åµã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã™ã‚‹ã¨ã€5 ã‚¿ãƒ¼ãƒ³ã®é–“è¦–ç•ŒåŠå¾„ã‚’ 3 ã¾ã§ä½ä¸‹ã•ã›ã‚‹ã€‚
* é™¸ä¸Šã§ã¯æ¢ç´¢ä¸­ã«ä½ç¢ºç‡ã§ä¼‘æ¯ (HP+1) ã¾ãŸã¯ç¼¶è©°å…¥æ‰‹ã‚¤ãƒ™ãƒ³ãƒˆãŒç™ºç”Ÿã€‚
* æ°´åŸŸã§ã¯ä½ç¢ºç‡ã§ã‚¯ãƒ©ã‚²ãŒå‡ºç¾ã—ã€æ¥è§¦ã™ã‚‹ã¨HPã‚’1å¤±ã„ãƒ©ã‚¤ãƒ³å¼·åº¦ã‚‚10æ¸›å°‘ã™ã‚‹ã€‚

## 7. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ« I/F è©³ç´°

| Producer | Consumer  | é–¢æ•° / Channel                   | å†…å®¹            |
| -------- | --------- | ------------------------------ | ------------- |
| mapgen   | game-core | `pub fn generate(seed) -> Map` | æ–°ãƒãƒƒãƒ—ç”Ÿæˆ        |
| ecology  | game-core | `pub fn spawn_fish(map)`       | é­š Entity é…ç½® (æ°´ã‚¿ã‚¤ãƒ«ã‹ã‚‰ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ) |
| fishing  | ui        | `pub struct TensionMeter`      | Draw + æ›´æ–°ãƒ¡ã‚½ãƒƒãƒ‰ |
| ui       | game-core | `pub struct UIContext`         | ãƒ­ã‚°è¿½åŠ , ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥  |

## 8. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

* `Result<T, GameError>` å…±é€šå‹ã‚’ crates é–“ã§å…±æœ‰ã€‚
* é‡å¤§ã‚¨ãƒ©ãƒ¼æ™‚ã¯ãƒ­ã‚°å‡ºåŠ›å¾Œã«ã‚¿ã‚¤ãƒˆãƒ«ã¸ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã€‚

## 9. ãƒ­ã‚®ãƒ³ã‚°

* `env_logger` ã§ trace/debug/info ãƒ¬ãƒ™ãƒ«åˆ‡æ›¿ã€‚
* ã‚²ãƒ¼ãƒ å†…ãƒ­ã‚°ã¨ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ­ã‚°ã‚’åˆ†é›¢ (feature flag)ã€‚

## 10. ãƒ†ã‚¹ãƒˆæ–¹é‡

| éšå±¤       | æ–¹æ³•                           | ã‚«ãƒãƒ¬ãƒƒã‚¸ç›®æ¨™   |
| -------- | ---------------------------- | --------- |
| ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ | `cargo test` ãƒ¦ãƒ‹ãƒƒãƒˆ            | 80%+      |
| ãƒãƒƒãƒ—ç”Ÿæˆ    | Golden Master ã‚¹ãƒŠãƒƒãƒ—æ¯”è¼ƒ         | å¤‰æ›´æ™‚ãƒ¬ãƒ“ãƒ¥ãƒ¼å¿…é ˆ |
| WASM     | Headless `wasm-bindgen-test` | èµ·å‹•ï½ã‚¿ã‚¤ãƒˆãƒ«è¡¨ç¤º |

## 11. CI ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ (GitHub Actions)

1. **Lint**: `cargo clippy -- -D warnings`
2. **Test**: `cargo test --all`
3. **Build Matrix**: ubuntu-latest, windows-latest, macos-latest
4. **WASM Build**: `wasm-pack build` + `npm run test`
5. **Release Upload**: tag pushã§ 3OS ãƒã‚¤ãƒŠãƒª + wasm.zip ã‚’ Release

## 12. æœªæ±ºå®šäº‹é … / TODO

* ãƒã‚¤ãƒˆç¢ºç‡ã®æ•°å¼èª¿æ•´ (è¦ã‚²ãƒ¼ãƒ ãƒãƒ©ãƒ³ã‚¹æ¤œè¨¼)
* è‰²å¼±ãƒ•ãƒ¬ãƒ³ãƒ‰ãƒªãƒ¼ãƒ‘ãƒ¬ãƒƒãƒˆ: `colorblind` è¨­å®šã§åˆ‡ã‚Šæ›¿ãˆæ¸ˆã¿

---

> ### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—
>
> 1. æœ¬å¤–éƒ¨è¨­è¨ˆã®ç²’åº¦ã‚„ UI ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã‚’ç¢ºèªã€‚
> 2. æœªæ±ºå®šäº‹é …ã®å„ªå…ˆåº¦ã‚’æ•´ç†ã—ã€Issue åŒ–ã€‚
> 3. I/F è©³ç´°ã‚’å®Ÿè£…ç€æ‰‹å‰ã«ãƒã‚¤ã‚¯ãƒ­è¨­è¨ˆã¸å±•é–‹ã€‚

ğŸ¾ **ãƒ¬ã‚ªã‚ˆã‚Š:** çªã£è¾¼ã¿ã‚„è¿½åŠ è¦æœ›ãŒã‚ã‚Œã°ãœã²ãƒ¯ãƒ³ï¼
