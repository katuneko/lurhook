# Lurhook 要件定義書（叩き台）

> **版数:** v0.1（2025‑05‑18）
> **作成者:** レオ（アシスタント）

---

## 1. 目的 / Purpose

* ASCII 表現のローグライク釣りゲーム **「Lurhook」** を開発し、プレイヤーに戦略的な探索と釣り体験を提供する。
* 趣味開発として継続的に育てられるよう、モジュール化と品質維持を重視する。

## 2. 背景 / Background

* 開発者の個人プロジェクトとして、Rust と bracket‑lib を実践的に習得する場を提供。
* 「質実剛健」なデザイン哲学：最小限の UI と純朴な ASCII 演出でゲーム本質に集中する。

## 3. 用語定義 / Glossary

| 用語          | 定義                      |
| ----------- | ----------------------- |
| **タイル**     | マップ上の 1 文字セル（陸・海・深海など）。 |
| **キャスト**    | 釣り糸を投げ入れる操作。            |
| **バイト**     | 魚が針に掛かるイベント。            |
| **テンションバー** | 糸の張力を示す UI 要素。          |

## 4. スコープ / Scope

* **対象**: ゲーム本体（オフライン）、ビルドスクリプト、アセット(JSON)。
* **除外**: ネットワーク対戦、グラフィカルタイルセット、モバイル固有 UI。

## 5. 利用者 / User Profiles

| 利用者        | スキルレベル    | 主な目的               |
| ---------- | --------- | ------------------ |
| カジュアルプレイヤー | ローグライク初心者 | シンプルな釣りと探索を体験したい   |
| コアゲーマー     | ローグライク熟練  | 高難度マップでレア魚ハイスコアを狙う |
| 開発者本人      | Rust 中級   | 学習と拡張実験            |

## 6. ゲームプレイ要件

### 6.1 基本ループ

1. マップ生成 → 2. 探索移動 → 3. 釣り → 4. 帰還 or 脱落 → 5. スコア集計。
* ゲームは完全ターン制で、キー操作を行ったときのみ1ターン進行する。

### 6.2 マップ生成

* BSP + パーリンノイズで海域/島をランダム生成。
* 浅瀬/深海フラグを各タイルに付与。

### 6.3 釣りメカニクス

| 番号        | 要件                      |
| --------- | ----------------------- |
| G‑FISH‑01 | キャスト方向と飛距離を入力可能にする。     |
| G‑FISH‑02 | 深度・餌によってバイト確率を計算する。     |
| G‑FISH‑03 | テンションバーで強度管理し、閾値超過で糸切れ。 |
| G‑FISH‑04 | 張力が0になるとフックアウトし釣り失敗。 |

### 6.4 プレイヤーステータス

* 満腹度は最大100でゲーム開始時に100。
* 1ターンごとに1減少し、0になると毎ターンHPが1減る。
* インベントリの魚を消費すると満腹度が20回復する。

### 6.5 生態系 / AI

* 魚は日中/夜間・潮流で行動パターンが変わる。
* 群れ AI：リーダーに追従しつつノイズで散逸。

### 6.6 UI / UX

* 80×25 ターミナル基準。
* ログウィンドウ、ステータスパネル、テンションバーのみ。

### 6.7 セーブ / ロード

* ゲーム状態を RON 形式で保存/復元。

## 7. 技術要件

| 項目      | 内容                                     |
| ------- | -------------------------------------- |
| 言語      | Rust stable (>=1.78)                   |
| 主要ライブラリ | bracket-lib 0.8, hecs 0.x, serde, ron  |
| OS 対応   | Windows / macOS / Linux (terminal)     |
| CI      | GitHub Actions：lint, test, cross‑build |
| バージョン管理 | Git (GitHub)                           |

## 8. 非機能要件

* **パフォーマンス**: 60 FPS 相当のターン処理 (<16ms) を維持。
* **可搬性**: `cargo build` で依存自動解決。外部 DLL 不要。
* **拡張性**: 新モジュール追加が 3 ファイル以内で完結すること。
* **アクセシビリティ**: キーリマップ機能、色盲配慮のパレット提供。

## 9. データ要件

* `assets/fish.json`: 魚種リスト (id, name, rarity, strength, min\_depth, max\_depth)。
* `assets/items.json`: 釣り竿・ルアー・餌。

## 10. セキュリティ要件

* 外部入力なしのオフラインゲームのため最低限。
* WASM 版公開時は Web 権限を限定（ファイルシステムアクセス無効）。

## 11. スケジュール / Milestones (概要)

| フェーズ   | 期間      | 成果物              |
| ------ | ------- | ---------------- |
| 0. 準備  | 2025‑05 | リポジトリ & ビルド通過    |
| 1. 基盤  | 2025‑06 | 移動可能なプレイヤー &空マップ |
| 2. マップ | 2025‑07 | ランダム水域生成         |
| 3. 釣り  | 2025‑08 | 釣りメカニクス v1       |
| 4. 拡張  | 2025‑09 | 魚 AI & 深度システム    |
| 5. 仕上げ | 未定      | バランス調整 & 配布      |

## 12. リスク & 対策

| リスク       | 影響       | 対策                            |
| --------- | -------- | ----------------------------- |
| モチベーション低下 | 進捗遅延     | DevLog と定期タグ付けで可視化            |
| ライブラリ非互換  | ビルド失敗    | `cargo update` を控え、semver を固定 |
| 仕様肥大      | スケジュール超過 | 必須 / 追加候補を分離し優先度管理            |

## 13. 受け入れ基準 / Acceptance

* 指定 OS で `cargo run` → タイトル～釣り～帰還まで一連を実行できる。
* README に操作方法が明記されている。
* `cargo test` でユニットテストが全て通過。

## 14. 将来拡張 / Future Work

* WASM 版デプロイ (GitHub Pages)。
* MOD API (Lua/Rhai)。
* ドット絵タイル化 (bracket-bevy 又は raylib)。

